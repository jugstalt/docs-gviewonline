
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Secrets Vault &#8212; Identityserver.Nova 5.0.0 Dokumentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic_mod.css?v=0.7.0-1" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/petite-vue.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="Payload Signing" href="signing.html" />
    <link rel="prev" title="Weitere Admin Werkzeuge" href="index.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="../index.html" title="Go to homepage">Identityserver.Nova 5.0.0 Dokumentation</a></h1>

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="../search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Schnellsuche</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Los" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html">Erste Schritte</a></li>
<li class="toctree-l1"><a class="reference internal" href="../clients/index.html">Clients verwalten</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Weitere Admin Werkzeuge</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Secrets Vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="signing.html">Payload Signing</a></li>
<li class="toctree-l2"><a class="reference internal" href="createcerts.html">Selbst-Signierte Zertifikate erstellen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../etc/index.html">Weitere Themen</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="secrets-vault">
<h1>Secrets Vault<a class="headerlink" href="#secrets-vault" title="Permalink to this heading">¶</a></h1>
<p>Das <strong>Secrets Vault</strong> dient zum zentralen Speichern von <strong>Secrets</strong> wie beispielsweise:</p>
<ul class="simple">
<li><p>ConnectionString</p></li>
<li><p>Passwörter</p></li>
<li><p>Client Secrets</p></li>
</ul>
<p>Die <strong>Secrets</strong> werden sogenannten <strong>Lockers</strong> zugeordnet. Eine Anwendung bekommt beispielsweise Zugriff auf einen <strong>Locker</strong> und kann die
darin enthaltenen <strong>Secrets</strong> abgreifen. Für jedes Secret können unterschiedliche <strong>Versionen</strong> angelegt werden. Ändert sich beispielsweise ein
<em>ConnectionString</em> kann eine neue Version für ein <strong>Secret</strong> angelegt werden. Sind alle <strong>Clients</strong> auf die neue Version des <em>ConnectionStrings</em>
umgestellt, kann die alte <strong>Version</strong> gelöscht werden.</p>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Idealerweise wird ein <strong>Locker</strong> pro <em>Client</em> angelegt. Im <strong>Locker</strong> gibt es nur die für den <em>Client</em> relevanten <strong>Secrets</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Beim Abholen eine <strong>Secrets</strong> kann auch auf die Angabe der <strong>Version</strong> verzichtet werden. Dann muss allerdings berücksichtigt werden,
dass der Client immer auf die zuletzt erstellte Version zugreift. Führt man eine neue <strong>Version</strong> an, holt sich ein <em>Client</em> beim
nächsten Zugriff die neu <strong>Version</strong> ab!</p>
</div>
<p>Zum Verwalten des <strong>Secrets Vault</strong> klickt man auf der <em>Admin Seite</em> auf die entsprechende Kachel.</p>
<section id="locker-anlegen">
<h2>Locker anlegen<a class="headerlink" href="#locker-anlegen" title="Permalink to this heading">¶</a></h2>
<p>Ein neuer Locker wird über das <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">new</span> <span class="pre">locker</span></code> Formular angelegt:</p>
<img alt="../_images/secretsvault1.png" src="../_images/secretsvault1.png" />
</section>
<section id="secret-anlegen">
<h2>Secret anlegen<a class="headerlink" href="#secret-anlegen" title="Permalink to this heading">¶</a></h2>
<p>Um eine <strong>Secret</strong> innerhalb eines <strong>Lockers</strong> anzulegen, öffnet man im entsprechenden Locker den Menüpunkt <code class="docutils literal notranslate"><span class="pre">Secrets</span></code> und erstellt über
das Formular <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">new</span> <span class="pre">secret</span></code> ein neues <strong>Secret</strong>. Hier muss einmal nur der Name und optional die Beschreibung des <strong>Secrets</strong> angeführt
werden:</p>
<img alt="../_images/secretsvault2.png" src="../_images/secretsvault2.png" />
</section>
<section id="secret-versionen-anlegen">
<h2>Secret Versionen anlegen<a class="headerlink" href="#secret-versionen-anlegen" title="Permalink to this heading">¶</a></h2>
<p>Um schließlich dem <strong>Secret</strong> einen Wert zu geben, müssen <strong>Versionen</strong> angelegt werden. Dazu wählt man zuerst das <strong>Secret</strong> aus der Liste aus
und wechselt zum Menüpunkt <code class="docutils literal notranslate"><span class="pre">Versions</span></code>:</p>
<img alt="../_images/secretsvault3.png" src="../_images/secretsvault3.png" />
<p>In der Liste erscheint die neue erstellte Version des <strong>Secrets</strong>. Erstellt man weiter Versionen, wird das neueste Version immer ganz oben angezeigt.
Mehrere Versionen machen Sinn, wenn sich ein ConnectionString ändern kann, zB neuer Datenbankserver. Hier kann eine neue Version angelegt werden,
und sukzessive alle Clients auf die neue Datenbank umgestellt werden. Danach können alte Versionen wieder gelöscht werden.</p>
<p>Klickt man auf den Link, der bei der <strong>Version</strong> angezeigt wird, öffnet sich ein <em>JSON</em> im Browser:</p>
<img alt="../_images/secretsvault4.png" src="../_images/secretsvault4.png" />
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Der letzte Teil der Url ist der <code class="docutils literal notranslate"><span class="pre">versionTimeStamp</span></code>. Dieser kann auch beim Abholen der <strong>Secret-Version</strong> weggelassen werden.
Damit wird immer die zuletzt erstellte Version zurück gegeben.</p>
<img alt="../_images/secretsvault5.png" src="../_images/secretsvault5.png" />
</div>
</section>
<section id="secret-abfragen">
<h2>Secret abfragen<a class="headerlink" href="#secret-abfragen" title="Permalink to this heading">¶</a></h2>
<p><strong>Secrets</strong> können mit der oben gezeigten Methode (Klick auf Link) abgeholt werden. Dieser Link ist allerdings nur für Administrator mit Browser
möglich. Möchte man diesen Link im Browser öffnen und ist nicht als Administrator angemeldet, wird man zum <em>Login</em> weiter geleitet.</p>
<p>Der Zugriff für Clients mit übergabe eines <strong>Bearer Tokens</strong>. Damit ein gültiger <em>Token</em> abgeholt werden sind folgende Schritte notwendig:</p>
<section id="api-resources-anlegen">
<h3>API Resources anlegen<a class="headerlink" href="#api-resources-anlegen" title="Permalink to this heading">¶</a></h3>
<p><em>IdentityServerNET</em> bietet eine API zum abfragen von Secrets (<a class="reference external" href="https://.../api/api/secretsvault?v=1">https://…/api/api/secretsvault?v=1</a>.0&amp;path={secret-version-path}).
Um diese API verwenden zu können, müssen zuerst die notwendigen <strong>API Resourcen</strong> angelegt werden. Dazu muss über die <em>Admin-Seite</em> in den
Bereich <strong>Resources (Identities &amp; APIs)</strong> und dort zum Menüpunkt <strong>API Resources</strong> gewechselt werden. Falls noch nicht vorhanden, muss
hier zuerst die API Resource <code class="docutils literal notranslate"><span class="pre">secrets-vault</span></code> erstellt werden:</p>
<img alt="../_images/secretsvault6.png" src="../_images/secretsvault6.png" />
<p>Für die Resource muss dann unter <code class="docutils literal notranslate"><span class="pre">Scopes</span></code> noch ein <strong>Scope</strong> mit dem Namen es <strong>Lockers</strong> eingereicht werden:</p>
<img alt="../_images/secretsvault7.png" src="../_images/secretsvault7.png" />
</section>
<section id="client-anlegen">
<h3>Client anlegen<a class="headerlink" href="#client-anlegen" title="Permalink to this heading">¶</a></h3>
<p>Damit ein Client auf den <strong>Locker</strong> zugreifen kann, muss von der <em>Admin Seite</em> in den Bereich <strong>Clients</strong> gewechselt werden und
dort ein <strong>API Client</strong> erstellt werden:</p>
<img alt="../_images/secretsvault8.png" src="../_images/secretsvault8.png" />
<p>Für den Client muss unter <code class="docutils literal notranslate"><span class="pre">Client</span> <span class="pre">Secrets</span></code> ein <strong>Secret</strong> vergeben werden, dass der Client später übergeben muss, um einen Token abzuholen.
Unter <code class="docutils literal notranslate"><span class="pre">Scopes</span></code> sind die beiden <strong>Scopes</strong> <code class="docutils literal notranslate"><span class="pre">secrets-vault</span></code> und <code class="docutils literal notranslate"><span class="pre">secrets-vault.{locker-name}</span></code> aus dem Bereich <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">existing</span> <span class="pre">resource</span> <span class="pre">scope</span></code>
hinzuzufügen:</p>
<img alt="../_images/secretsvault9.png" src="../_images/secretsvault9.png" />
</section>
<section id="secret-uber-http-request-abholen">
<h3>Secret über HTTP Request abholen<a class="headerlink" href="#secret-uber-http-request-abholen" title="Permalink to this heading">¶</a></h3>
<p>Zuerst muss ein gültiger <strong>Bearer Token</strong> abgeholt werden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">44300</span><span class="o">/</span><span class="n">connect</span><span class="o">/</span><span class="n">token</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">x</span><span class="o">-</span><span class="n">www</span><span class="o">-</span><span class="n">form</span><span class="o">-</span><span class="n">urlencoded</span>

<span class="n">grant_type</span><span class="o">=</span><span class="n">client_credentials</span><span class="o">&amp;</span>
<span class="n">client_id</span><span class="o">=</span><span class="n">my</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">secrets</span><span class="o">&amp;</span>
<span class="n">client_secret</span><span class="o">=</span><span class="n">secret</span><span class="o">&amp;</span>
<span class="n">scope</span><span class="o">=</span><span class="n">secrets</span><span class="o">-</span><span class="n">vault</span> <span class="n">secrets</span><span class="o">-</span><span class="n">vault</span><span class="o">.</span><span class="n">my</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">locker</span>
</pre></div>
</div>
<p>Wird ein <strong>Access Token</strong> zurück gegeben, kann dieser für den zum Abfragen des <strong>Secrets</strong> verwendet werden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET https://localhost:44300/api/secretsvault?v=1.0&amp;path=my-api-locker/db-connectionstring
Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkR...
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Hier wurde im Pfad keine Version mitgegeben. Möchte man eine bestimmte Version Abfragen muss diese im Pfad mitgegeben werden, zB
<a class="reference external" href="https://localhost:44300/api/secretsvault?v=1.0&amp;path=my-api-locker/db-connectionstring">https://localhost:44300/api/secretsvault?v=1.0&amp;path=my-api-locker/db-connectionstring</a>/{version}</p>
</div>
</section>
<section id="secret-uber-identityservernet-clients-abholen">
<h3>Secret über IdentityServerNET.Clients abholen<a class="headerlink" href="#secret-uber-identityservernet-clients-abholen" title="Permalink to this heading">¶</a></h3>
<p>Das <strong>nuget</strong> Packet <code class="docutils literal notranslate"><span class="pre">IdentityServerNET.Clients</span></code> bietet folgende Methoden,
um auf die <strong>Secrets API</strong> zuzugreifen:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dotnet<span class="w"> </span>add<span class="w"> </span>package<span class="w"> </span>IdentityServerNET.Clients
</pre></div>
</div>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span><span class="w"> </span><span class="n">secretsVaultClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IdentityServerNET</span><span class="p">.</span><span class="n">Clients</span><span class="p">.</span><span class="n">SecretsVaultClient</span><span class="p">(</span><span class="s">&quot;my-api-secrets&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;secret&quot;</span><span class="p">);</span>
<span class="k">await</span><span class="w"> </span><span class="n">secretsVaultClient</span><span class="p">.</span><span class="n">OpenLocker</span><span class="p">(</span><span class="s">&quot;https://localhost:44300&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;my-api-locker&quot;</span><span class="p">);</span>
<span class="kt">var</span><span class="w"> </span><span class="n">secretResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">secretsVaultClient</span><span class="p">.</span><span class="n">GetSecret</span><span class="p">(</span><span class="s">&quot;db-connectionstring&quot;</span><span class="p">);</span>

<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">secretResponse</span><span class="p">.</span><span class="n">GetValue</span><span class="p">())</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon"><</span><span>Page contents<span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">></span><span>Page contents:<span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">Secrets Vault</a><ul>
<li><a class="reference internal" href="#locker-anlegen">Locker anlegen</a></li>
<li><a class="reference internal" href="#secret-anlegen">Secret anlegen</a></li>
<li><a class="reference internal" href="#secret-versionen-anlegen">Secret Versionen anlegen</a></li>
<li><a class="reference internal" href="#secret-abfragen">Secret abfragen</a><ul>
<li><a class="reference internal" href="#api-resources-anlegen">API Resources anlegen</a></li>
<li><a class="reference internal" href="#client-anlegen">Client anlegen</a></li>
<li><a class="reference internal" href="#secret-uber-http-request-abholen">Secret über HTTP Request abholen</a></li>
<li><a class="reference internal" href="#secret-uber-identityservernet-clients-abholen">Secret über IdentityServerNET.Clients abholen</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
                <a href="index.html">
                    <span class="icon"><</span><span>Weitere Admin Werkzeuge</span></a>
                
            </div>

            <div class="right">
                
                    <a href="signing.html"><span>Payload Signing</span><span class="icon">></span></a>
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
        &#169; Copyright 2024, Jürgen Gstaltmaier.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>

<p id="theme_credit">Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a></p>
  </body>
</html>